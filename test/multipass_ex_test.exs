defmodule MultipassExTest do
  use ExUnit.Case
  doctest MultipassEx

  test "Blows-up on decoding a rails generated multipass" do
    decode = MultipassEx.genDecode("trustedform","b825369ddd76f42ed8a65e86de793e5be46fed39ee82be9dbefc141f01515d89311267b7d2085f48d3236de7a81fca97ae1669d2d08a3f6f9193edbfa5113117")

    ruby_multipass = "YmThUWzNGYRQSJMe5Jr4whCnyuMiXFljJTyiODUk2i5PUUDmhe0qdd1ra-5W1OJSSwTmSuSSMDELkNSWaYKzpwLRl6TwFavmA5nYUpuAIB-qjAHhz45jQP-N1yguTcLKpj2GX5hj3OBakYz8xAsgEVx6-Y73uIZzOfFdcEfKB3EPCSM5KE6zgv5uCvcHsRLxo0p63hr5-PHHmirWpBaOvvd8mJIMVBs9gl-83Z7WiDjXSQ8iN-j1vdtaDeis95HsxZLN2UuGEz2ImzSpY7Hs1ShFlQQK27p8ns020cWEYrXURkw6kATrnGwbIOhz3Es2Qa3LeKKjGOnPRDUKIDEJwEOpTQVSHh2pK1StAi6RtFKSGLAwCq9WrWAc2XqcMyVUUeFE4U82vYMErw6Qf6_l94whxW6H86GTw6w3JSmAzZ_P5ap3aXEeliOZedwcqkhAhGy-tvZlnFwEsF0X8A__zmre9nj6pTPfl29Bmwpr_akciXk91tVBEcD9zxGA-FlWp_WjSRnR0UVJ_iUsCrfJ_VRvOHcCCwv_FHqkFLMbqnZJpYrN62h6SATQWHHs8mUYL8CL-JLziQGwnTZi035s3mim6UiS8hwGcROVvh_NtAC6196DG8F6QyCbqXhs4MmT7pJ2O2Q9uWHHLXvB07VTqW6CVzoZXNFCUH953t9QXn3naWXNJ_29R3NuHvxn0fKPiNiFNWJvdpzQhW1qj1p1zHNxcm_wtKeQ2HVa3lHn_gXDv7NDoBhXH0gqwk_2xcepXSNpm7B5nFRO2lM0iRH-5XVk3p5OsOzQ-rFIaLnaabKrQBATWrQhGbrERxq1XM9SvP21bjLbjT60c-um7ysjDI8ey4R8VTv-RB720r6XaQ4hEmedojdKWTLD8Mb16azwfZvKiNyogLPM1edmlSSCqUSqrAZwknnyRmsuVGfoSHyLpSySXkx_vttqY0zhOMylx9MR_TH7JtIZ5Voq-QAI-N05ocilJCNQAIziFveJyh5PCIZIi-RA-ySPWS53pJnrV-GCayMjs4k8XInahpK1zDayFKcpJWw9g3RpBHoNieQpz8hj0_P2zCN3sNk49vFYYhmkKL2xphZuMeDVec7lI4AADahTcthKM0NEWw4_yb55GW_2QSS1Lq0qmVaiGfuY_AhqlpD_DNTgp3bT1dr5E8kMzpHjqgJDpmpE1gqDAid7k9nmRZbgIWP_kmoftLYyfe_XZbrEs33r059I8SlTqCooDEm8gh0Nnjl7WqfEPEcGUoVVKWn_gCSLwNipQ6hVP57I8440o-pAYbf-WF6fPfTirPAoF2_AKotmkqLEBX4sfaWwbQxqVd5jwYRoDeAK1vRvX6FW7Ynu7gw2cOKYszsDH53C4gPhUU3SM0XGvbPRrRsMUo8XRHBd079SjzbsHnIOXiDj3QBegLPNpXJ3yeV5kO3HATSlwj7bgxHyH7usVFTRWs1X8R4CJx6wugchSkB-NQd9GMjzPTqgIAbGeUSZC0E09cmVZm5aZ_LPr-YfHXuFiKEzT9EBodmWnCDZyCPKg1v8ttdrwtkzKhFyZNcVvQnU_TYcR7a20Z_LfB9S1vAX9P0_cnV-huicy_yWrtJWTivurW2yI5NFqDIDfKWCPG7_sx7IxoYnLzohENdgJ9W9hXUA3ijAV5zrctK7WRojeR2LWhtVLr5e4fLXZuN8K8ifVikcyNETtyl_PnuCkn4MVWUwWtPtPECRNBi_F9RPYqntzs_WunOhtg162hbo6N7IjHXGNIVGlUN21hZnlYsyc1M0-i0aPh9Nc7lSsOrFLf1zH-jiN0non2YFaXj-zcdS-lRfPma6RJdSqnk-CXXw6-ftY_iG5xbA7FsLFq1nf7V-LYOEgyMYRUN9VgbhYCXUcHGnCVrgG0mfYWwD5eq6GLaBLn26pOh6OvcXcUWZhBRUApRJM8VH82U0XdF0-fioxbI6PX3L5ZQZp4AyjcGdKsSHQaFJyTdivUv_Xw1eQJmJLvtdYScVDy3umnrGomywWCA1NNo-u9YD8MSzidXGj1JIjvST94x5nwAP12kfj4UalWjR85qIm2fq9IoxuDdPrhacydvgAnhfmZTAx4aK2PYnZo5uD2wpzSeLTKRYY_-RGsfmpoZM4ZKkHK3PM1EHqf1Je8WsQxcMX7TB4CVSkyOOXSNCg74oBp5LGkVkf6PwhPQYt9TJCncixbQjuaBAOm7B7ISU2x54K7GV7iZWl0SK5s-TO__bOmOeg4bgVNkkA0WtbvJWQ2XSkcVyx6kM0FoAi-9EmKo8Gxi3qGbwjZXoCtV9yz0QvbdB"

    decoded_multipass = ruby_multipass |> Base.decode64!() |> decode.()
    assert decoded_multipass |> String.length > 1
  end
end
